2021-0423-01

SELECT
    EMPLOYEE_ID AS 사원번호, 
    EMP_NAME AS 사원명, 
    DEPARTMENT_ID AS 부서번호, 
    SALARY AS 급여, 
    NVL(TO_CHAR(COMMISSION_PCT,'0.99'),'실적없음') AS 영업실적, -- expr과 val은 타입이 동일
    ROUND(SALARY*NVL(COMMISSION_PCT*0.5,0)) AS 보너스, 
    SALARY +ROUND(SALARY*NVL(COMMISSION_PCT*0.5,0)) AS 지급액
FROM
    HR.EMPLOYEES
;

SELECT
    B.MEM_ID AS 회원번호, 
    B.MEM_NAME AS 회원명, 
    NVL(SUM(A.CART_QTY),0) AS 구매수량합, 
    NVL(SUM(A.CART_QTY*C.PROD_COST),0) AS 구매금액합
FROM
    CART A RIGHT OUTER 
    JOIN MEMBER B ON(A.CART_MEMBER=B.MEM_ID
    AND A.CART_NO LIKE '200506%') LEFT OUTER 
    JOIN PROD C ON(A.CART_PROD=C.PROD_ID)
    GROUP BY  B.MEM_ID,B.MEM_NAME
    ORDER BY 1
;

SELECT
    EMPLOYEE_ID,
    COMMISSION_PCT,
    NVL2(COMMISSION_PCT,SALARY+(SALARY*COMMISSION_PCT),SALARY)
FROM
    HR.EMPLOYEES
;

SELECT
    PROD_ID AS 상품코드, 
    PROD_NAME AS 상품명, 
    PROD_LGU AS 분류코드, 
    NVL2(PROD_COLOR, PROD_COLOR, '색상정보 없음') AS 색상
    --NVL(PROD_CLOLOR,'색상정보 없음') AS 색상
FROM
;


SELECT
    EMPLOYEE_ID AS 사원번호, 
    EMPLOYEE_ID AS 부서코드,
    COMMISSION_PCT AS 영업실적, 
    NVL2(COMMISSION_PCT,TO_CHAR(SALARY*COMMISSION_PCT,'999,999,999'), '영업실적 없음') AS 비고 
FROM
    HR.EMPLOYEES
;

SELECT
    EMPLOYEE_ID AS 사원번호, 
    DEPARTMENT_ID AS 직무코드, 
    START_DATE AS 시작일, 
    END_DATE AS 종료일, 
--    NVL(TO_CHAR(NULLIF(EXTRACT(YEAR FROM END_DATE)
--    ,EXTRACT(YEAR FROM START_DATE))),' ')
    NVL(NULLIF(TO_CHAR(END_DATE,'YYYY'),
    TO_CHAR(START_DATE,'YYYY')),' ')
    AS 비고
FROM
    HR.JOB_HISTORY 
    ORDER BY 1
;